<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<BorderPane prefHeight="600.0" prefWidth="800.0" style="-fx-background-color: #f5f5f5;" xmlns="http://javafx.com/javafx/25" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.unmadgamer.lostandfoundfinal.controller.ChatController">
    <top>
        <VBox style="-fx-background-color: white; -fx-border-color: #e0e0e0; -fx-border-width: 0 0 1 0;">
            <HBox alignment="CENTER_LEFT" spacing="15" style="-fx-padding: 15;">
                <Button text="â† Back to Dashboard" onAction="#handleBackToDashboard"
                        style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 5;">
                    <font>
                        <Font name="Calibri Bold" size="12.0" />
                    </font>
                </Button>
                <Label text="ðŸ’¬ Messaging Center" style="-fx-font-size: 20; -fx-font-weight: bold; -fx-text-fill: #2c3e50;" />
                <Region HBox.hgrow="ALWAYS" />
                <Label fx:id="unreadCountLabel" text="No unread messages" style="-fx-font-size: 12; -fx-text-fill: #27ae60;" />
                <Button text="ðŸ”„ Refresh" onAction="#refreshConversations"
                        style="-fx-background-color: #95a5a6; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 5;">
                    <font>
                        <Font name="Calibri Bold" size="12.0" />
                    </font>
                </Button>
                <Button text="âž• New Chat" onAction="#startNewConversation"
                        style="-fx-background-color: #27ae60; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 5;">
                    <font>
                        <Font name="Calibri Bold" size="12.0" />
                    </font>
                </Button>
            </HBox>
        </VBox>
    </top>

    <center>
        <SplitPane dividerPositions="0.3" style="-fx-background-color: white;">
            <VBox style="-fx-border-color: #e0e0e0; -fx-border-width: 0 1 0 0;">
                <Label text="Conversations" style="-fx-font-size: 16; -fx-font-weight: bold; -fx-padding: 15 15 10 15;" />
                <ListView fx:id="conversationsList" VBox.vgrow="ALWAYS" />
            </VBox>

            <VBox style="-fx-background-color: #f8f9fa;">
                <VBox style="-fx-background-color: white; -fx-border-color: #e0e0e0; -fx-border-width: 0 0 1 0; -fx-padding: 15;">
                    <Label fx:id="chatWithLabel" text="Chat with: --" style="-fx-font-size: 16; -fx-font-weight: bold;" />
                    <Label fx:id="itemContextLabel" text="Regarding item #123" style="-fx-font-size: 12; -fx-text-fill: #666;" visible="false" />
                </VBox>

                <ScrollPane fx:id="messagesScrollPane" VBox.vgrow="ALWAYS" style="-fx-background: #f8f9fa; -fx-border-color: transparent;">
                    <VBox fx:id="messagesContainer" style="-fx-padding: 10;" />
                </ScrollPane>

                <VBox fx:id="noConversationView" alignment="CENTER" visible="true" VBox.vgrow="ALWAYS">
                    <Label fx:id="noConversationLabel" text="Select a conversation or start a new one to begin chatting"
                           style="-fx-text-fill: #666; -fx-font-size: 14; -fx-padding: 50;" />
                </VBox>

                <VBox style="-fx-background-color: white; -fx-border-color: #e0e0e0; -fx-border-width: 1 0 0 0; -fx-padding: 15;">
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <TextArea fx:id="messageInput" promptText="Type your message here... (Enter to send, Shift+Enter for new line)"
                                  prefRowCount="3" HBox.hgrow="ALWAYS"
                                  style="-fx-background-radius: 10; -fx-border-radius: 10;" />
                        <Button fx:id="sendButton" text="Send" onAction="#sendMessage"
                                style="-fx-background-color: #007bff; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 10; -fx-pref-width: 80;">
                            <font>
                                <Font name="Calibri Bold" size="12.0" />
                            </font>
                        </Button>
                    </HBox>
                    <Label text="ðŸ’¡ Tip: Press Enter to send, Shift+Enter for new line"
                           style="-fx-text-fill: #999; -fx-font-size: 10; -fx-padding: 5 0 0 0;" />
                </VBox>
            </VBox>
        </SplitPane>
    </center>
</BorderPane>